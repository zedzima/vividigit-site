{# Service card — matches catalog.html renderServiceCard() #}
{% set cats = item.tags.categories | default([]) %}
{% set industries = item.tags.industries | default([]) %}
{% set countries = item.tags.countries | default([]) %}
{% set langs = item.tags.languages | default([]) %}
{% set rels = item.relationships | default({}) %}
{% set industry_count = industries | length %}
{% set country_count = countries | length %}
{% set language_count = langs | length %}
{% set task_count = rels.available_tasks | default([], true) | length %}
{% if not task_count %}
    {% set task_count = rels.tasks | default([], true) | length %}
{% endif %}
{% if not task_count and rels.door_opener_task %}
    {% set task_count = 1 %}
{% endif %}
{% set url = item.url | default('/services/' ~ item.slug) %}
{% set delivery = item.config.delivery | default('') %}
{% set category_label_map = {'digital-marketing': 'Digital Marketing', 'seo': 'SEO', 'aeo': 'AEO', 'content': 'Content', 'ppc': 'PPC', 'analytics': 'Analytics', 'social-media': 'Social Media', 'email': 'Email', 'cro': 'CRO', 'video': 'Video', 'pr': 'PR', 'automation': 'Automation', 'marketplace-management': 'Marketplace', 'affiliate': 'Affiliate'} %}
<a href="{{ url }}" class="service-card">
    <div class="service-card-header">
        <div class="service-categories">
            {% for cat in cats[:3] %}
            <span class="service-category">{{ category_label_map.get(cat, cat|replace('-', ' ')|title) }}</span>
            {% endfor %}
        </div>
        {% if delivery %}
        <span class="service-spec-count">{{ delivery|replace('-', ' ')|title }}</span>
        {% endif %}
    </div>
    <h3>{{ item.menu or item.title }}</h3>
    <p>{{ item.description }}</p>
    {% if industry_count or country_count or language_count or task_count %}
    <div class="service-card-meta">
        {% if industry_count %}<span class="service-metric">{{ industry_count }} industr{% if industry_count == 1 %}y{% else %}ies{% endif %}</span>{% endif %}
        {% if country_count %}<span class="service-metric">{{ country_count }} countr{% if country_count == 1 %}y{% else %}ies{% endif %}</span>{% endif %}
        {% if language_count %}<span class="service-metric">{{ language_count }} language{% if language_count != 1 %}s{% endif %}</span>{% endif %}
        {% if task_count %}<span class="service-metric">{{ task_count }} task{% if task_count != 1 %}s{% endif %}</span>{% endif %}
    </div>
    {% endif %}
    <div class="service-card-footer">
        {% if item.config.from_price or item.config.price %}
        <span class="service-price">From ${{ '{:,.0f}'.format((item.config.from_price or item.config.price)|float) }}</span>
        {% else %}
        <span></span>
        {% endif %}
        <span class="service-cta">View Service →</span>
    </div>
</a>
